<!DOCTYPE html>
<html lang="en">
<head>
  <meta name="theme-color" content="#f28b8b">

  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>PMPML Ticket</title>
  <style>
    html,body{
      height:100%;
      margin:0;
      font-family: 'Poppins', sans-serif;
      background:linear-gradient(180deg, #ebabab);
      display:flex;
      flex-direction:column;
      align-items:center;
      justify-content:flex-start;
      color:#fff;
    }

    /* ✅ Top red header bar like in mobile view */
    .mobile-header {
      width:100%;
      max-width:400px;
      color:#fff;
      display:flex;
      justify-content:space-between;
      align-items:center;
      padding:10px 16px;
      font-size:14px;
      font-weight:500;
      position:sticky;
      top:0px;
      border-top-left-radius:10px;
      border-top-right-radius:10px;
    }
    .mobile-header .left { font-size:18px; font-weight:700; cursor:pointer; }
    .mobile-header .right { display:flex; gap:14px; font-size:13px; }
    .mobile-header .right span { text-decoration:underline; cursor:pointer; }

    /* ✅ Ticket box */
    .ticket{
      width:335px;
      background:linear-gradient(#2a2a2a,#191919);
      border-radius:14px;
      overflow:visible;
    /*  box-shadow:0 20px 40px rgba(0,0,0,0.6); */
      position:relative;
      text-align:center;
      padding-bottom:18px;
      margin-top:42px;
    }

    .ticket::before, .ticket::after{
      content:"";
      position:absolute;
      left:-14px;
      width:28px;height:28px;
      background:#ebabab;
      border-radius:50%;
      z-index:3;
      top: var(--cut-center, 170px);
      transform: translateY(-50%);
    /*  box-shadow: 0 0 0 4px rgba(0,0,0,0.18) inset; */
    }
    .ticket::after{ left:auto; right:-14px; }

    .header{
      background:#ec2b2b;
      padding:10px 14px;
      font-weight:700;
      font-size:15px;
      color:#fff;
      border-top-left-radius:14px;
      border-top-right-radius:14px;
    }
    .top-info{
      display:flex;
      justify-content:space-between;
      padding:10px 18px  7px;
      gap:71px;
    }
    .info-block{
      display:flex;
      flex-direction:column;
      align-items:flex-start;
      min-width:71px;
    }
    .info-block .label{
      font-size:12px;
      color:#cfcfcf;
      margin-bottom:6px;
      letter-spacing:0.2px;
      text-align:left;
    }
    .info-block .value{
      font-size:17px;
      font-weight:700;
      color:#fff;
      line-height:1;
      text-align:left;
    }
    .fare-value {
      display: flex;
      flex-direction: column;
      align-items: flex-start;
      line-height: 1;
      position: relative;
    }

    .route {
      display:flex;
      justify-content:center;
      align-items:center;
      gap:12px;
      padding:8px 16px;
      font-size:15px;
      font-weight:600;
      color:#e9e9e9;
    }

    .dotted {
      height:1px;
      margin:13px 1px;
      background-image: repeating-linear-gradient(
        to right,
        #888,
        #888 3px,
        transparent 2px,
        transparent 6px
      );
      position:relative;
      z-index:1;
    }

    .times{ padding:8px 14px 4px; }
    .times-row{
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:10px;
      font-size:11px;
      margin:0 6px;
    }
    .time-block{
      display:flex;
      flex-direction:column;
      align-items:flex-start;
      min-width:120px;
    }
    .time-block .label{ font-size:11px; color:#cfcfcf; margin-bottom:7px; }
    .time-block .value{ font-size:12px; font-weight:700; color:#fff; line-height:1.05; }

    .ticket-number{
      font-family: monospace;
      font-size:13px;
      color:#f6f6f6;
      opacity:0.95;
      margin-top:25px;
      transform-origin:center;
    }

    .logo-box{
      display:flex;
      justify-content:center;
      align-items:center;
      padding:10px 10px 4px;
    }
    .logo-box img{
      width:130px;
      height:auto;
      display:block;
      filter:none;
      animation: zoom 2.6s ease-in-out infinite;
      transform-origin:center center;
    }
    @keyframes zoom{
      0%{ transform: scale(1); }
      50%{ transform: scale(1.12); }
      100%{ transform: scale(1); }
    }

    .countdown {
      font-size:12px;
      color:#cfcfcf;
      padding:8px 12px;
      margin:6px 18px 0;
      letter-spacing:0.4px;
      font-weight:600;
      background:linear-gradient(transparent, rgba(255,255,255,0.02));
      border-radius:8px;
    }
    .countdown.expired { color:#ff6b6b; font-weight:800; }

    /* ===========================
       ✅ QR bottom section (ADDED)
       This is the green "Show QR code" bar that appears
       DOWN-SIDE / below the ticket (exactly as requested).
       Do not change other parts of the file.
       =========================== */
    .qr-bottom {
      width:320px;
      border-radius:12px;
      margin-top:70px;
      margin-bottom:18px;
      display:flex;
      align-items:center;
      padding:12px 14px;
      gap:65px;
      background: linear-gradient(180deg, #469b71, #469b71);
      box-shadow: 0 6px 18px rgba(0,0,0,0.28);
      justify-content:flex-start;
            border: 3.5px solid rgba(255,255,255,0.8); /* ✅ new border */

    }
    .qr-bottom .qr-icon {
      width:20px;
      height:20px;
      border-radius:8px;
      background: rgba(255,255,255,0.12);
      display:flex;
      align-items:center;
      justify-content:center;
      padding:4px;
      flex-shrink:0;
    }
    .qr-bottom .qr-icon svg { width:8px; height:28px; fill: #198f1d; opacity:0.95; }
    .qr-bottom .qr-text { font-size:13px; font-weight:800; color:#0b920f; opacity:0.95; }

    @media (max-width:360px){
      .ticket{ width:300px; }
      .logo-box img{ width:120px; }
      .qr-bottom { width:300px; }
    }
  </style>
</head>
<body>

  <!-- ✅ Added mobile header -->
  <div class="mobile-header">
    <div class="left">×</div>
    <div class="right">
      <span>Need Help?</span>
      <span>All tickets</span>
    </div>
  </div>

  <!-- ✅ Ticket Section (UNCHANGED) -->
  <div class="ticket" id="ticket">
    <div class="header">पुणे महानगर परिवहन महामंडळ लि.</div>

    <div class="top-info">
      <div class="info-block">
        <div class="label">Route</div>
        <div class="value">372</div>
      </div>
      <div class="info-block">
        <div class="label">Ticket Count</div>
        <div class="value">3F</div>
      </div>
      <div class="info-block">
        <div class="label">Fare</div>
        <div class="value fare-value">₹60</div>
      </div>
    </div>

    <div class="route">
      <div>Power House</div>
      <div style="font-size:40px;opacity:0.95;">→</div>
      <div>Shivaji Chowk</div>
    </div>

    <div class="dotted" id="dashed-top"></div>

    <div class="times">
      <div class="times-row">
        <div class="time-block">
          <div class="label">Booking Time</div>
          <div class="value" id="bookTime">--</div>
        </div>
        <div class="time-block" style="text-align:right;">
          <div class="label">Validity Time</div>
          <div class="value" id="validTime">--</div>
        </div>
      </div>
    </div>

    <div class="ticket-number">2509271616J12QZ5</div>
    <div class="dotted" id="dashed-bottom"></div>

    <div class="logo-box">
      <img src="pmpl.png" alt="PMPML logo" id="logo" />
    </div>

    <div class="countdown" id="countdown">Expires in 00:40:00</div>
  </div>
  <!-- ===========================
       ✅ QR bottom section ADDED BELOW the ticket (as requested)
       This visually matches the green "Show QR code" bar in your image.
       Replace or remove svg if you want a different icon.
       =========================== -->
  <div class="qr-bottom" role="button" aria-label="Show QR code">
    <div class="qr-icon" aria-hidden="true">
      <!-- small inline QR-like icon (keeps file self-contained) -->
      <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
        <rect x="3" y="3" width="6" height="6"></rect>
        <rect x="15" y="3" width="6" height="6"></rect>
        <rect x="3" y="15" width="6" height="6"></rect>
        <rect x="11" y="11" width="2" height="2"></rect>
        <rect x="14" y="11" width="2" height="2"></rect>
        <rect x="11" y="14" width="2" height="2"></rect>
        <rect x="14" y="14" width="2" height="2"></rect>
      </svg>
    </div>
    <div class="qr-text">Show QR code</div>
  </div>
  <!-- =========================== END QR bottom section =========================== -->

 <script>
(function(){
  const routeVal = localStorage.getItem('route') || '372';
  const ticketCountVal = localStorage.getItem('ticketCount') || '3F';
  const fareVal = localStorage.getItem('fare') || '60';
  const fromVal = localStorage.getItem('from') || 'Power House';
  const toVal = localStorage.getItem('to') || 'Shivaji Chowk';

  document.querySelector('.top-info .info-block:nth-child(1) .value').textContent = routeVal;
  document.querySelector('.top-info .info-block:nth-child(2) .value').textContent = ticketCountVal;
  document.querySelector('.top-info .info-block:nth-child(3) .fare-value').textContent = `₹${fareVal}`;
  document.querySelector('.route div:nth-child(1)').textContent = fromVal;
  document.querySelector('.route div:nth-child(3)').textContent = toVal;

  localStorage.clear();

  const bookEl = document.getElementById('bookTime');
  const validEl = document.getElementById('validTime');
  const countdownEl = document.getElementById('countdown');
  const ticketNumEl = document.querySelector('.ticket-number');
  const validityOffsetMinutes = 50;

  const booking = new Date();
  const validity = new Date(booking.getTime() + validityOffsetMinutes * 60 * 1000);

  // ✅ Generate Ticket Number: YYMMDDHHMM + 5 random letters
  function generateTicketNumber() {
    const yy = String(booking.getFullYear()).slice(-2);
    const mm = String(booking.getMonth() + 1).padStart(2, '0');
    const dd = String(booking.getDate()).padStart(2, '0');
    const hh = String(booking.getHours()).padStart(2, '0');
    const min = String(booking.getMinutes()).padStart(2, '0');
    const letters = Array.from({length: 5}, () =>
      String.fromCharCode(65 + Math.floor(Math.random() * 26))
    ).join('');
    return `${yy}${mm}${dd}${hh}${min}${letters}`;
  }

  ticketNumEl.textContent = generateTicketNumber();

  function formatDateShort(dt){
    const day = dt.getDate();
    const monthNames = ["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];
    const month = monthNames[dt.getMonth()];
    const yearShort = String(dt.getFullYear()).slice(-2);
    let hours = dt.getHours();
    const mins = dt.getMinutes();
    const ampm = hours >= 12 ? 'PM' : 'AM';
    hours = hours % 12;
    if (hours === 0) hours = 12;
    const hh = String(hours).padStart(2,'0');
    const mm = String(mins).padStart(2,'0');
    return `${day} ${month}, ${yearShort} | ${hh}:${mm} ${ampm}`;
  }

  bookEl.textContent = formatDateShort(booking);
  validEl.textContent = formatDateShort(validity);

  function startCountdown(endDate){
    function update(){
      const now = new Date();
      let diff = Math.floor((endDate - now) / 1000);
      if (diff <= 0){
        countdownEl.classList.add('expired');
        countdownEl.textContent = "Expired";
        clearInterval(intervalId);
        return;
      }
      const hrs = Math.floor(diff / 3600);
      const mins = Math.floor((diff % 3600) / 60);
      const secs = diff % 60;
      function z(n){ return n < 10 ? '0' + n : String(n); }
      countdownEl.textContent = `Expires in ${z(hrs)}:${z(mins)}:${z(secs)}`;
    }
    update();
    const intervalId = setInterval(update, 1000);
  }
  startCountdown(validity);
})();
</script>
</body>
</html>
